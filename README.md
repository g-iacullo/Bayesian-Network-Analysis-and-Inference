# Bayesian-Network-Analysis-and-Inference

C++ implementation of a Bayesian Network parser (BIF format), topological sorter, and exact inference engine using the Enumeration-Ask algorithm. It allows users to specify an optional query variable and evidence via command-line arguments for calculating conditional or marginal probabilities.


````
# Bayesian Network Analysis and Inference

## üß† Overview

This repository hosts a robust **C++ implementation** designed for the analysis and exact inference within **Bayesian Networks (BNs)**.

The core functionality includes:
1.  **Parsing** of network structure and Conditional Probability Tables (CPTs) from the standard **BIF (Bayes Interchange Format)**.
2.  **Topological Sorting** to ensure a valid processing order for inference algorithms.
3.  **Exact Inference** using the **Enumeration-Ask** algorithm (a variable elimination method without dynamic programming), which calculates conditional marginal probabilities $P(X | E)$ given any evidence $E$.

This project is ideal for educational purposes in Artificial Intelligence, Probabilistic Graphical Models, and advanced C++ programming.

## ‚öôÔ∏è Project Structure and Components

| File/Component | Description |
| :--- | :--- |
| `main.cpp` | The primary driver. Handles command-line arguments, generates the dummy `gradient.bif`, parses the network, executes the topological sort, and runs the inference engine. |
| `BayesianNetwork.h` | Defines the core data structures: `Variable`, `BayesianNetwork`, and type aliases (`Evidence`, `CPT`). Declares all helper functions. |
| `BayesianNetwork.cpp` | Contains the implementation for network operations: BIF parsing, topological sort (using DFS), CPT lookup, and the `calculateProbabilitiesWithEvidence` (Enumeration-Ask) inference function. |
| `gradient.bif` | A sample Bayesian Network generated by `main.cpp` for testing the full inference pipeline (A, B, C, D, E). |

## üöÄ How to Build and Run

### Prerequisites
* A C++ compiler supporting C++11 or later (e.g., g++ or clang).

### Build Instructions

Assuming you have a standard C++ setup (e.g., using `g++`):

```bash
# Compile the source files
g++ main.cpp BayesianNetwork.cpp -o main -std=c++11

# The executable 'main' is now ready.
````

### Running Examples

The executable supports specifying a BIF file, evidence, and a specific query variable.

|**Command**|**Description**|
|---|---|
|`./main`|Runs with the default `gradient.bif` and no evidence. Calculates all marginals $P(X)$.|
|`./main -f my_net.bif`|Loads the network from a custom BIF file.|
|`./main -e a=true,c=false`|Calculates $P(X|
|`./main -e d=false -q a`|Calculates the specific diagnostic probability $P(a|
|`./main -e a=true,c=true -q e`|Calculates $P(e|

### Example Output (Partial)

When running `./main -e a=true -q d`, you will see:

```
Evidence provided: 
   a = true
Query variable: d
...
--- Calculated Probabilities ---
P(d | E):
   true -> 0.792857 
   false -> 0.207143
   (Sum: 1.0)
P(a = true) is fixed by evidence.
...
```

## üìê Algorithm Highlights

### Topological Sorting

The network variables are ordered using a **Depth-First Search (DFS)** approach. This ensures that every variable is processed _after_ all of its parents have been processed, which is mandatory for multiplying conditional probabilities during the forward pass.

### Exact Inference (Enumeration-Ask)

The calculateProbabilitiesWithEvidence function implements a forward-pass strategy:

$$P(X_1, \dots, X_n, E) = \prod_{i=1}^{n} P(X_i | \text{Parents}(X_i))$$

1. It iterates through the variables in **topological order**.
    
2. It maintains the **joint probability distribution** of all variables processed so far, incorporating the likelihood of any observed **evidence ($E$)** by setting inconsistent configurations to $0$.
    
3. Finally, it calculates the marginal conditional probabilities $P(X_i | E)$ by **summing out** (marginalizing) the joint probability $P(X_1, \dots, X_n, E)$ over all variables other than $X_i$, and then **normalizing** by the total probability of the evidence $P(E)$.